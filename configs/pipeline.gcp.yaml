# ─────────────────────────────────────────────────────────────────────────────
# Souli Pipeline — GCP / Docker Compose config
#
# Service hostnames match docker-compose.gcp.yml service names.
# Sensitive values (API keys, secrets) come from .env — never hardcode them.
# ─────────────────────────────────────────────────────────────────────────────

run:
  outputs_dir: /app/outputs   # bind-mounted persistent disk on GCE
  max_workers: 4

energy:
  expressions_sheet: "ExpressionsMapping"
  framework_sheet: "Inner energy Framework"
  expr_column_map:
    "Main Question": "Problem statement"
    "Category": "Aspects of Woman Track"
    "Related Inner Issues": "deeper_blocks/ pshychlogical issues"
    "Reality Commitment Check": "Duality Check"
  required_expr_cols:
    - "Problem statement"
    - "Aspects of Woman Track"
    - "Duality Check"
    - "deeper_blocks/ pshychlogical issues"
    - "energy_node/energy block behind it/ inner block"
  framework_key_col: "energy_node"
  framework_cols:
    - "typical_signs"
    - "primary_healing_principles"
    - "primary_practices ( 7 min quick relief)"
    - "deeper_meditations_program ( 7 day quick recovery)"
    - "longer_program ( 7 month resilience building)"
    - "Caution"
    - "Health"
  aspects_allowed:
    - "Personal Life"
    - "Professional Work"
    - "Family"
    - "Parenting"
    - "Relationships & safety"
    - "Body/Health"
    - "Self, emotions & inner world"
    - "Life roles & responsibilities"
    - "Life transitions and losses"
    - "Digital Life & Modern Pressures"
    - "Unknown"
  nodes_allowed:
    - "blocked_energy"
    - "depleted_energy"
    - "normal_energy"
    - "outofcontrol_energy"
    - "scattered_energy"
  gates:
    min_problem_len: 12
    min_duality_len: 25
    min_blocks_len: 8
    min_blocks_count: 2

youtube:
  caption_langs: "en,hi"
  whisper_model: "medium"
  chunking:
    max_seconds: 55
    max_words: 220
    max_gap: 1.3
    min_words_to_split: 35
  segments:
    min_dur: 0.35
    min_words: 2
    max_gap: 0.20
  cleaning:
    overlap_words: 20
  classify:
    min_words_noise: 25
    min_words_teaching: 30
  scoring:
    meaning_min_score: 3
    junk_drop_threshold: 7

# LLM via Ollama container (service name "ollama" in docker-compose)
llm:
  enabled: false        # set true to use Ollama for teaching card extraction
  adapter: "ollama"
  ollama:
    model: "llama3.1"
    endpoint: "http://ollama:11434"   # docker-compose service name
    timeout_s: 180
    temperature: 0.7
    num_ctx: 4096

# Qdrant vector store — "qdrant" service in docker-compose
retrieval:
  embedding_model: "sentence-transformers/all-MiniLM-L6-v2"
  top_k_teaching: 5
  qdrant_host: "qdrant"            # docker-compose service name
  qdrant_port: 6333
  qdrant_collection: "souli_chunks"

# Conversation engine — talks to Ollama container
conversation:
  chat_model: "llama3.1"
  tagger_model: "qwen2.5:1.5b"
  ollama_endpoint: "http://ollama:11434"   # docker-compose service name
  rag_top_k: 3
  max_intake_turns: 4
  temperature: 0.75

# Voice pipeline — LiveKit Cloud (free tier) or self-hosted on GCE
# Values injected from .env via env vars: LIVEKIT_URL, LIVEKIT_API_KEY, LIVEKIT_API_SECRET
voice:
  livekit_url: "wss://YOUR_PROJECT.livekit.cloud"   # overridden by LIVEKIT_URL env var
  livekit_api_key: "YOUR_KEY"                        # overridden by LIVEKIT_API_KEY
  livekit_api_secret: "YOUR_SECRET"                  # overridden by LIVEKIT_API_SECRET
  room_name: "souli-room"
  stt_provider: "whisper"
  whisper_model: "base"
  tts_provider: "edge_tts"
  tts_voice: "en-IN-NeerjaNeural"
